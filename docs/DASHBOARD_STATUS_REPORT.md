# ๐ ฺฏุฒุงุฑุด ูุถุนุช ฺฉุงูู ุฏุงุดุจูุฑุฏ

**ุชุงุฑุฎ ุชูู ฺฏุฒุงุฑุด:** ${new Date().toLocaleDateString('fa-IR')}  
**ูุณุฑ:** `http://localhost:3000/`  
**ูุงู:** `app/page.tsx`

---

## ๐ฏ ุฎูุงุตู ุงุฌุฑุง

ุฏุงุดุจูุฑุฏ ูุฏุฑุช ุฑุณุชูุฑุงู ฺฉ ุตูุญู ุฌุงูุน ู ูุฏุฑู ุงุณุช ฺฉู ุชูุงู ุงุทูุงุนุงุช ฺฉูุฏ ุฑุง ุฏุฑ ฺฉ ูฺฏุงู ููุงุด ูโุฏูุฏ. ุงู ุฏุงุดุจูุฑุฏ ุดุงูู ฺฉุงุฑุชโูุง ุขูุงุฑุ ูููุฏุงุฑูุง ุชุนุงููุ ูุณุชโูุง ุงุฎุฑุ ู ุนููุงุช ุณุฑุน ุงุณุช.

---

## ๐ฆ ุจุฎุดโูุง ุงุตู ุฏุงุดุจูุฑุฏ

### 1๏ธโฃ **Header (ูุฏุฑ)**
**ูููุนุช:** ุจุงูุง ุตูุญู  
**ูฺฺฏโูุง:**
- โ ุนููุงู "ุฏุงุดุจูุฑุฏ ูุฏุฑุช" ุจุง gradient
- โ ููุงุด ุชุงุฑุฎ ู ุฒูุงู ุจู ุตูุฑุช real-time
- โ ุฏฺฉูู ุจูโุฑูุฒุฑุณุงู (Refresh) ุจุง ุงููุดู
- โ ุทุฑุงุญ Glassmorphism ู backdrop blur

**ฺฉุฏ:** ุฎุทูุท 456-515

---

### 2๏ธโฃ **ฺฉุงุฑุชโูุง ุขูุงุฑ (Stats Cards)**
**ูููุนุช:** ุฒุฑ ูุฏุฑ  
**ุชุนุฏุงุฏ:** 5 ฺฉุงุฑุช  
**ูฺฺฏโูุง:**
- โ **ูุฑูุด ุงูุฑูุฒ**: ููุงุด ูุจูุบ ูุฑูุด ุงูุฑูุฒ ุจุง ููุงุณู ุฏุฑูุฒ
- โ **ุณูุฏ ูุงุฎุงูุต**: ููุงุด ุณูุฏ ูุงุฎุงูุต ุจุง ุฏุฑุตุฏ
- โ **ุณูุฏ ุฎุงูุต ุงูุฑูุฒ**: ููุงุด ุณูุฏ ุฎุงูุต ุงูุฑูุฒ
- โ **ูุดุชุฑุงู ูุนุงู**: ุชุนุฏุงุฏ ูุดุชุฑุงู ูุนุงู + ูุดุชุฑุงู ุฌุฏุฏ ุงู ูุงู
- โ **ููุฌูุฏ ฺฉู**: ุชุนุฏุงุฏ ูุดุฏุงุฑูุง ููุฌูุฏ

**ููุจุน ุฏุงุฏู:** `/api/dashboard`  
**ฺฉุฏ:** ุฎุทูุท 518-597

---

### 3๏ธโฃ **ูููุฏุงุฑ ูุฑูุด (Sales Chart)**
**ูููุนุช:** ุจุฎุด ุงุตู ุตูุญู  
**ูฺฺฏโูุง:**
- โ ูููุฏุงุฑ ุฎุท ุชุนุงูู ุจุง ุฏู ุฎุท (ูุฑูุด ู ุณูุฏ)
- โ ุงูุชุฎุงุจ ุฏูุฑู: ุงูุฑูุฒุ ฺฉ ูุงูุ ถ ูุงูุ ฺฉ ุณุงู
- โ ุทุฑุงุญ ูููุงู ู ูุฏุฑู ุจุง ุฑูฺฏโูุง ุฎูุซ
- โ Tooltip ุจุฑุง ููุงุด ุฌุฒุฆุงุช
- โ ุขูุงุฑ ุฎูุงุตู ุฒุฑ ูููุฏุงุฑ:
  - ุจุดุชุฑู ูุฑูุด
  - ุจุดุชุฑู ุณูุฏ
  - ฺฉู ูุฑูุด
  - ฺฉู ุณูุฏ
  - ูุงูฺฏู ุฑูุฒุงูู

**ููุจุน ุฏุงุฏู:** `/api/orders/chart-data?period={period}`  
**ฺฉุงููพูููุช:** `components/Charts/LineChart.tsx`  
**ฺฉุฏ:** ุฎุทูุท 600-827

---

### 4๏ธโฃ **ูููุฏุงุฑ ุฑูุดโูุง ูพุฑุฏุงุฎุช (Payment Methods Chart)**
**ูููุนุช:** ฺฉูุงุฑ ูููุฏุงุฑ ูุฑูุด  
**ูฺฺฏโูุง:**
- โ ูููุฏุงุฑ ุฏุงุฑูโุง (Pie Chart)
- โ ููุงุด ุฏุฑุตุฏ ูุฑ ุฑูุด ูพุฑุฏุงุฎุช
- โ ุฑูฺฏโุจูุฏ: ููุฏ (ุณุจุฒ)ุ ฺฉุงุฑุช (ุจููุด)ุ ฺฺฉ (ุจููุด)

**ููุจุน ุฏุงุฏู:** `/api/sales-reports?reportType=payment&dateRange=month`  
**ฺฉุงููพูููุช:** `components/Charts/PieChart.tsx`  
**ฺฉุฏ:** ุฎุทูุท 829-867

---

### 5๏ธโฃ **ูุญุจูุจโุชุฑู ุบุฐุงูุง (Top Menu Items)**
**ูููุนุช:** ุฒุฑ ูููุฏุงุฑูุง  
**ูฺฺฏโูุง:**
- โ ูุณุช 5 ุบุฐุง ูพุฑูุฑูุด
- โ ููุงุด ุฑุชุจูุ ูุงูุ ุชุนุฏุงุฏ ูุฑูุดุ ู ุฏุฑุขูุฏ
- โ ุฏฺฉูู "ูุดุงูุฏู ููู" ุจุฑุง ุฑูุชู ุจู `/reports/sales`

**ููุจุน ุฏุงุฏู:** `/api/reports/top-menu-items?limit=5`  
**ฺฉุฏ:** ุฎุทูุท 869-905

---

### 6๏ธโฃ **ุขุฎุฑู ูุงฺฉุชูุฑูุง (Recent Invoices)**
**ูููุนุช:** ุณูุช ุฑุงุณุช (ุฏุฑ grid)  
**ูฺฺฏโูุง:**
- โ ูุณุช 5 ูุงฺฉุชูุฑ ุงุฎุฑ
- โ ููุงุด ุดูุงุฑู ูุงฺฉุชูุฑุ ูุงู ูุดุชุฑุ ูุจูุบุ ู ูุถุนุช
- โ ุฏฺฉูู "ูุดุงูุฏู ููู" ุจุฑุง ุฑูุชู ุจู `/accounting/invoices`

**ููุจุน ุฏุงุฏู:** `/api/invoices?limit=5&type=sales&sortBy=createdAt&sortOrder=desc`  
**ฺฉุฏ:** ุฎุทูุท 910-970

---

### 7๏ธโฃ **ุขุฎุฑู ฺฺฉโูุง (Recent Cheques)**
**ูููุนุช:** ุณูุช ฺูพ (ุฏุฑ grid)  
**ูฺฺฏโูุง:**
- โ ูุณุช 5 ฺฺฉ ุงุฎุฑ
- โ ููุงุด ุดูุงุฑู ฺฺฉุ ูุงู ุจุงูฺฉุ ูุจูุบุ ูุถุนุชุ ู ุชุงุฑุฎ ุณุฑุฑุณุฏ
- โ ุฏฺฉูู "ูุดุงูุฏู ููู" ุจุฑุง ุฑูุชู ุจู `/accounting/cheques`

**ููุจุน ุฏุงุฏู:** `/api/cheques?limit=5&sortBy=createdAt&sortOrder=desc`  
**ฺฉุฏ:** ุฎุทูุท 973-1037

---

### 8๏ธโฃ **ุงุนูุงูโูุง ุณุณุชู (Notifications)**
**ูููุนุช:** ุฒุฑ ูุงฺฉุชูุฑูุง ู ฺฺฉโูุง  
**ูฺฺฏโูุง:**
- โ ูุณุช ูุดุฏุงุฑูุง ููุฌูุฏ
- โ ููุงุด ููุน ูุดุฏุงุฑ (warning, error, info)
- โ ุฏฺฉูู "ูุดุงูุฏู ููู" ุจุฑุง ุฑูุชู ุจู `/inventory/stock-alerts`

**ููุจุน ุฏุงุฏู:** `/api/stock-alerts?status=active&limit=5`  
**ฺฉุฏ:** ุฎุทูุท 1040-1101

---

### 9๏ธโฃ **ุนููุงุช ุณุฑุน (Quick Actions)**
**ูููุนุช:** ูพุงู ุตูุญู  
**ุชุนุฏุงุฏ:** 4 ุฏฺฉูู  
**ูฺฺฏโูุง:**
- โ **ูุงฺฉุชูุฑ ุฌุฏุฏ**: `/operations/quick-sale`
- โ **ุณูุงุฑุด ุฌุฏุฏ**: `/operations/table-order`
- โ **ูุดุชุฑ ุฌุฏุฏ**: `/customers/list?action=add` (ุจุงุฒ ฺฉุฑุฏู ูุฑู ุงุถุงูู ฺฉุฑุฏู)
- โ **ฺฏุฒุงุฑุดุงุช**: `/reports/general`

**ฺฉุฏ:** ุฎุทูุท 1104-1178

---

## ๐ API Endpoints ุงุณุชูุงุฏู ุดุฏู

### 1. `/api/dashboard`
**ููุน:** GET  
**ุชูุถุญุงุช:** ุฏุงุฏูโูุง ุงุตู ุฏุงุดุจูุฑุฏ  
**ุฏุงุฏูโูุง ุจุฑฺฏุดุช:**
- ูุฑูุด ุงูุฑูุฒ
- ุณูุฏ ูุงุฎุงูุต ู ุฎุงูุต
- ุจุดุชุฑู ุบุฐุงูุง ูุฑูุฎุชู ุดุฏู
- ูุดุชุฑุงู ููุงุฏุงุฑ
- ูุดุฏุงุฑูุง ููุฌูุฏ
- ุขูุงุฑ ุตูุฏููุฏุงุฑ

**Collections ุงุณุชูุงุฏู ุดุฏู:**
- `invoices`
- `orders`
- `menu_items`
- `customer_loyalties`
- `inventory_items`
- `stock_alerts`
- `item_ledger`
- `customers`
- `cashier_sessions`
- `receipts_payments`

---

### 2. `/api/orders/chart-data`
**ููุน:** GET  
**Query Parameters:**
- `period`: `today` | `month` | `6months` | `year`

**ุชูุถุญุงุช:** ุฏุงุฏูโูุง ูููุฏุงุฑ ูุฑูุด ุงุฒ ุณูุงุฑุดุงุช  
**ุฏุงุฏูโูุง ุจุฑฺฏุดุช:**
- ุขุฑุงูโุง ุงุฒ ุฏุงุฏูโูุง ูุฑูุด ู ุณูุฏ ุจุฑ ุงุณุงุณ ุฏูุฑู
- ฺฏุฑููโุจูุฏ:
  - `today`: ุณุงุนุช (0:00 ุชุง 23:00)
  - `month`: ุฑูุฒุงูู (1 ุจููู ุชุง 30 ุจููู)
  - `6months`: ูุงูุงูู
  - `year`: ูุงูุงูู

**Collection ุงุณุชูุงุฏู ุดุฏู:** `orders`  
**ููุชุฑ:** ููุท ุณูุงุฑุดุงุช ุจุง status `completed` ุง `paid`

---

### 3. `/api/sales-reports`
**ููุน:** GET  
**Query Parameters:**
- `reportType=payment`
- `dateRange=month`

**ุชูุถุญุงุช:** ุฏุงุฏูโูุง ุฑูุดโูุง ูพุฑุฏุงุฎุช  
**ุฏุงุฏูโูุง ุจุฑฺฏุดุช:** ุฏุฑุตุฏ ูุฑ ุฑูุด ูพุฑุฏุงุฎุช

---

### 4. `/api/reports/top-menu-items`
**ููุน:** GET  
**Query Parameters:**
- `limit=5`

**ุชูุถุญุงุช:** ูพุฑูุฑูุดโุชุฑู ุขุชูโูุง ููู  
**ุฏุงุฏูโูุง ุจุฑฺฏุดุช:** ูุณุช ุบุฐุงูุง ุจุง ุฑุชุจูุ ุชุนุฏุงุฏ ูุฑูุดุ ู ุฏุฑุขูุฏ

---

### 5. `/api/invoices`
**ููุน:** GET  
**Query Parameters:**
- `limit=5`
- `type=sales`
- `sortBy=createdAt`
- `sortOrder=desc`

**ุชูุถุญุงุช:** ุขุฎุฑู ูุงฺฉุชูุฑูุง  
**ุฏุงุฏูโูุง ุจุฑฺฏุดุช:** ูุณุช ูุงฺฉุชูุฑูุง ุงุฎุฑ

---

### 6. `/api/cheques`
**ููุน:** GET  
**Query Parameters:**
- `limit=5`
- `sortBy=createdAt`
- `sortOrder=desc`

**ุชูุถุญุงุช:** ุขุฎุฑู ฺฺฉโูุง  
**ุฏุงุฏูโูุง ุจุฑฺฏุดุช:** ูุณุช ฺฺฉโูุง ุงุฎุฑ

---

### 7. `/api/stock-alerts`
**ููุน:** GET  
**Query Parameters:**
- `status=active`
- `limit=5`

**ุชูุถุญุงุช:** ูุดุฏุงุฑูุง ููุฌูุฏ  
**ุฏุงุฏูโูุง ุจุฑฺฏุดุช:** ูุณุช ูุดุฏุงุฑูุง ูุนุงู

---

### 8. `/api/customers`
**ููุน:** GET  
**Query Parameters:**
- `status=active`
- `limit=50`

**ุชูุถุญุงุช:** ูุดุชุฑุงู ูุนุงู  
**ุฏุงุฏูโูุง ุจุฑฺฏุดุช:** ูุณุช ูุดุชุฑุงู ูุนุงู ุจุฑุง ูุญุงุณุจู ุขูุงุฑ

---

## ๐พ State Management

### State Variables
```typescript
const [dashboardData, setDashboardData] = useState<any>(null)
const [summaryData, setSummaryData] = useState<any>(null)
const [salesChartData, setSalesChartData] = useState<any[]>([])
const [paymentMethodsData, setPaymentMethodsData] = useState<any[]>([])
const [topMenuItems, setTopMenuItems] = useState<any[]>([])
const [recentInvoices, setRecentInvoices] = useState<any[]>([])
const [recentCheques, setRecentCheques] = useState<any[]>([])
const [notifications, setNotifications] = useState<any[]>([])
const [chartPeriod, setChartPeriod] = useState<'today' | 'month' | '6months' | 'year'>('month')
const [activeCustomersCount, setActiveCustomersCount] = useState(0)
const [newCustomersThisMonth, setNewCustomersThisMonth] = useState(0)
const [refreshing, setRefreshing] = useState(false)
```

---

## โก ุจูููโุณุงุฒโูุง

### 1. Caching
- โ ุงุณุชูุงุฏู ุงุฒ `sessionStorage` ุจุฑุง cache ุฏุงุฏูโูุง
- โ ูุฏุช ุฒูุงู cache: 2 ุฏููู (120000ms)
- โ Cache key ุจุฑ ุงุณุงุณ ุฏูุฑู ุงูุชุฎุงุจ

### 2. Lazy Loading
- โ ุงุณุชูุงุฏู ุงุฒ `dynamic import` ุจุฑุง ูููุฏุงุฑูุง
- โ ฺฉุงูุด bundle size

### 3. Parallel API Calls
- โ ุงุณุชูุงุฏู ุงุฒ `Promise.allSettled` ุจุฑุง ูุฑุงุฎูุงู ููุฒูุงู APIูุง
- โ ฺฉุงูุด ุฒูุงู ุจุงุฑฺฏุฐุงุฑ

### 4. State Updates
- โ ุงุณุชูุงุฏู ุงุฒ `useTransition` ู `startTransition` ุจุฑุง batch updates
- โ ุจูุจูุฏ performance

### 5. Auto Refresh
- โ ุจูโุฑูุฒุฑุณุงู ุฎูุฏฺฉุงุฑ ูุฑ 2 ุฏููู
- โ ููุท ููุช ุตูุญู visible ุงุณุช

---

## ๐จ ุทุฑุงุญ ู UI

### ุงุณุชุงู ฺฉู
- โ ุทุฑุงุญ ูุฏุฑู ุจุง Glassmorphism
- โ Backdrop blur effects
- โ Gradient backgrounds
- โ Hover effects ู animations
- โ Dark mode support
- โ Responsive design

### ุฑูฺฏโุจูุฏ
- โ ฺฉุงุฑุชโูุง ุขูุงุฑ: ุฑูฺฏโูุง gradient (emerald, blue, green, purple, orange)
- โ ูููุฏุงุฑ ูุฑูุด: ุฑูฺฏโูุง ุฎูุซ (slate, gray)
- โ ฺฉุงุฑุชโูุง ุขูุงุฑ ูููุฏุงุฑ: ุฑูฺฏโูุง ุฎูุซ (slate, gray, zinc)
- โ ุนููุงุช ุณุฑุน: ุฑูฺฏโูุง gradient ุจุฑุง ูุฑ ุฏฺฉูู

---

## ๐ ูุญุงุณุจุงุช ู ููุทู

### 1. ูุฑูุด ุงูุฑูุฒ
- ุงุฒ `invoices` ุจุง `type: 'sales'` ู `status: { $ne: 'cancelled' }`
- ููุงุณู ุจุง ุฏุฑูุฒ ุจุฑุง ูุญุงุณุจู ุชุบุฑ

### 2. ุณูุฏ ูุงุฎุงูุต
- Revenue: ุงุฒ `invoices` (totalAmount)
- COGS: ุงุฒ `item_ledger` ุจุง `documentType: 'sale'`
- Gross Profit = Revenue - COGS

### 3. ุณูุฏ ุฎุงูุต ุงูุฑูุฒ
- ุงูููุช: ููุฏ `profit` ุงุฒ `invoices`
- Fallback: `grossProfit` ุงฺฏุฑ `profit` ููุฌูุฏ ูุจุงุดุฏ

### 4. ูููุฏุงุฑ ูุฑูุด
- ุงุฒ `orders` collection
- ููุท ุณูุงุฑุดุงุช `completed` ุง `paid`
- ูุญุงุณุจู ุจุฑ ุงุณุงุณ `total` ูุฑ ุณูุงุฑุด
- ุณูุฏ: ุงุฒ ููุฏ `profit` ุง 30% ุงุฒ ูุฑูุด

---

## ๐ Flow ุฏุงุฏูโูุง

```
1. Component Mount
   โ
2. Check Cache (sessionStorage)
   โโ Cache ููุฌูุฏ ู ูุนุชุจุฑ โ ุงุณุชูุงุฏู ุงุฒ cache
   โโ Cache ููุฌูุฏ ูุณุช ุง ูููุถ ุดุฏู โ ุงุฏุงูู
   โ
3. Fetch Data (Parallel)
   โโ /api/dashboard
   โโ /api/orders/chart-data?period={period}
   โโ /api/sales-reports?reportType=payment
   โโ /api/reports/top-menu-items
   โโ /api/invoices
   โโ /api/cheques
   โโ /api/stock-alerts
   โโ /api/customers
   โ
4. Process Data
   โโ Format sales chart data
   โโ Format payment methods
   โโ Format notifications
   โโ Calculate stats
   โ
5. Update State (Batch)
   โโ setDashboardData
   โโ setSalesChartData
   โโ setPaymentMethodsData
   โโ ...
   โ
6. Save to Cache
   โโ sessionStorage.setItem()
   โ
7. Auto Refresh (ูุฑ 2 ุฏููู)
```

---

## โ ูุถุนุช ุจุฎุดโูุง

| ุจุฎุด | ูุถุนุช | API | ููุจุน ุฏุงุฏู |
|-----|-------|-----|-----------|
| Header | โ ฺฉุงูู | - | Local state |
| ฺฉุงุฑุชโูุง ุขูุงุฑ | โ ฺฉุงูู | `/api/dashboard` | `invoices`, `item_ledger` |
| ูููุฏุงุฑ ูุฑูุด | โ ฺฉุงูู | `/api/orders/chart-data` | `orders` |
| ูููุฏุงุฑ ูพุฑุฏุงุฎุช | โ ฺฉุงูู | `/api/sales-reports` | `invoices` |
| ูุญุจูุจโุชุฑู ุบุฐุงูุง | โ ฺฉุงูู | `/api/reports/top-menu-items` | `menu_items`, `invoices` |
| ุขุฎุฑู ูุงฺฉุชูุฑูุง | โ ฺฉุงูู | `/api/invoices` | `invoices` |
| ุขุฎุฑู ฺฺฉโูุง | โ ฺฉุงูู | `/api/cheques` | `cheques` |
| ุงุนูุงูโูุง | โ ฺฉุงูู | `/api/stock-alerts` | `stock_alerts` |
| ุนููุงุช ุณุฑุน | โ ฺฉุงูู | - | Navigation |

---

## ๐ ูุดฺฉูุงุช ุดูุงุฎุชู ุดุฏู

ูฺ ูุดฺฉู ุดูุงุฎุชูโุดุฏูโุง ูุฌูุฏ ูุฏุงุฑุฏ. ุชูุงู ุจุฎุดโูุง ุจู ุฏุฑุณุช ฺฉุงุฑ ูโฺฉููุฏ.

---

## ๐ฎ ุจูุจูุฏูุง ุขูุฏู (ูพุดููุงุฏ)

1. **Real-time Updates**: ุงุณุชูุงุฏู ุงุฒ WebSocket ุจุฑุง ุจูโุฑูุฒุฑุณุงู real-time
2. **Export Data**: ุงูฺฉุงู export ูููุฏุงุฑูุง ู ุขูุงุฑ ุจู PDF/Excel
3. **Custom Date Range**: ุงูฺฉุงู ุงูุชุฎุงุจ ุจุงุฒู ุฒูุงู ุฏูุฎูุงู ุจุฑุง ูููุฏุงุฑ
4. **More Charts**: ุงุถุงูู ฺฉุฑุฏู ูููุฏุงุฑูุง ุจุดุชุฑ (ูุซูุงู ูููุฏุงุฑ ููุงุณูโุง)
5. **Dashboard Customization**: ุงูฺฉุงู ุดุฎุตโุณุงุฒ ุฏุงุดุจูุฑุฏ ุชูุณุท ฺฉุงุฑุจุฑ

---

## ๐ ุงุฏุฏุงุดุชโูุง ูู

- ุงุณุชูุงุฏู ุงุฒ `useTransition` ุจุฑุง ุจูุจูุฏ UX ุฏุฑ state updates
- Cache duration: 2 ุฏููู (ูุงุจู ุชูุธู)
- ุชูุงู API calls ุจุง `Promise.allSettled` ุจุฑุง handle errors
- ุงุณุชูุงุฏู ุงุฒ `dynamic import` ุจุฑุง lazy loading ูููุฏุงุฑูุง
- ุชูุงู ุจุฎุดโูุง responsive ู mobile-friendly ูุณุชูุฏ

---

**ุชูู ุดุฏู ุชูุณุท:** Auto (Cursor AI Assistant)  
**ุขุฎุฑู ุจูโุฑูุฒุฑุณุงู:** ${new Date().toLocaleDateString('fa-IR')}

